{
  "v": 1,
  "id": "ab54d5e8-3495-4f2e-9647-e8572295297b",
  "rev": 1,
  "name": "BD Training Day 3",
  "summary": "BD Training Day 3",
  "description": "BD Training Day 3",
  "vendor": "Team Awesome",
  "url": "",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "32badf1d-4ed5-4307-8df0-2cf5a5700ce2",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "Firewall Stream"
        },
        "stream_rules": [],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "Firewall Logs"
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.1+7bd8532"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "3bf62201-1e35-4b21-a238-5d75c0d4455f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Firewall Logs Processing"
        },
        "description": {
          "@type": "string",
          "@value": "Process Firewall logs"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Firewall Logs Processing\"\nstage 1 match either\nrule \"Parse - Firewall Logs - Base Parser\"\nstage 2 match either\nrule \"Route - Firewall Logs - Reroute logs\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "32badf1d-4ed5-4307-8df0-2cf5a5700ce2"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.1+7bd8532"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "38452db3-53d8-4867-9b0c-dc1c14643983",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Firewall Routing Pipeline"
        },
        "description": {
          "@type": "string",
          "@value": "Route firewall logs to Firewall Stream"
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Firewall Routing Pipeline\"\nstage 0 match either\nrule \"Route - Firewall Logs - Route to Firewall Stream\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "db9b1e9a-1fa7-4bb2-8cf2-448a3ac4fb78"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.1+7bd8532"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "081333f5-768e-459d-8669-3307487483bc",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Parse - Firewall Logs - Base Parser"
        },
        "description": {
          "@type": "string",
          "@value": "Parse Firewall Logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Parse - Firewall Logs - Base Parser\"\nwhen\n    true\nthen\n    let x = key_value(\n        value: to_string($message.message),\n        trim_value_chars: '\"'\n    );\n    \n    set_fields(x);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.1+7bd8532"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "7ded77ae-1061-4faf-a841-efbaee8640b3",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Route - Firewall Logs - Reroute logs"
        },
        "description": {
          "@type": "string",
          "@value": "Reroute logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Route - Firewall Logs - Reroute logs\"\nwhen\n    $message.action != \"ALLOW\"\nthen\n    drop_message();\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.1+7bd8532"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "60c00610-26a7-4938-b780-f1907bcbd3d9",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Route - Firewall Logs - Route to Firewall Stream"
        },
        "description": {
          "@type": "string",
          "@value": "Route firewall logs to Firewall Stream"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Route - Firewall Logs - Route to Firewall Stream\"\nwhen\n    contains(\n        value: to_string($message.message),\n        search: \"zone=LAB\"\n    )\nthen\n    route_to_stream(\n        name: \"Firewall Stream\",\n        remove_from_default: true\n    );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.1+7bd8532"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "db9b1e9a-1fa7-4bb2-8cf2-448a3ac4fb78",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Default Stream"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.3.1+7bd8532"
        }
      ]
    }
  ]
}