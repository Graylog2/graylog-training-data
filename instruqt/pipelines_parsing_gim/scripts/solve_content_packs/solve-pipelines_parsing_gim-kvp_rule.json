{"description":"","title":"Parse - Firewall - KVP","rule_builder":{"operator":"AND","conditions":[{"id":"660dc67cd4f4181e1aaa6b43","function":"from_input","params":{"id":null,"name":"RAW TCP"},"outputvariable":null,"negate":false,"step_title":"Check if message arrived on input 'RAW TCP'","operator":null,"conditions":null,"errors":[]}],"actions":[{"id":"660dc684d4f4181e1aaa6b44","function":"get_field","params":{"field":"message","message":null},"outputvariable":"output_1","negate":false,"step_title":"Retrieve value for field 'message'","operator":null,"conditions":null,"errors":[]},{"id":"660dc68cd4f4181e1aaa6b45","function":"to_string","params":{"value":"$output_1","default":null},"outputvariable":"output_2","negate":false,"step_title":"Convert '$output_1' to string","operator":null,"conditions":null,"errors":[]},{"id":"660dc694d4f4181e1aaa6b46","function":"key_value","params":{"value":"$output_2","delimiters":null,"kv_delimiters":null,"ignore_empty_values":true,"allow_dup_keys":true,"handle_dup_keys":"take_first","trim_key_chars":null,"trim_value_chars":null},"outputvariable":"output_3","negate":false,"step_title":"Convert key/value string '$output_2' to map","operator":null,"conditions":null,"errors":[]},{"id":"660dc69ad4f4181e1aaa6b47","function":"set_fields","params":{"fields":"$output_3","prefix":null,"suffix":null,"message":null,"clean_fields":null},"outputvariable":null,"negate":false,"step_title":"Set fields from map '$output_3'","operator":null,"conditions":null,"errors":[]}],"errors":null},"source":"rule \"Parse - Firewall - KVP\"\nwhen\n  from_input(\n    name : \"RAW TCP\"\n  )\nthen\n  let output_1 = get_field(\n    field : \"message\"\n  );\n  let output_2 = to_string(\n    value : output_1\n  );\n  let output_3 = key_value(\n    value : output_2,\n    ignore_empty_values : true,\n    allow_dup_keys : true,\n    handle_dup_keys : \"take_first\"\n  );\n  set_fields(\n    fields : output_3\n  );\nend"}