{"id":"eeae7969-9dde-4d07-80d2-8f8692080a18","rev":1,"v":"1","name":"solve-pipelines_parsing_gim-pipelines-grok","summary":"solve-pipelines_parsing_gim-pipelines-grok","description":"","vendor":"Graylog Service Delivery","url":"","created_at":"2024-03-26T19:19:50.899Z","server_version":"5.2.5+7eaa89d","parameters":[],"entities":[{"id":"8f443dd2-ea0f-43c4-a64a-a20888569947","type":{"name":"pipeline","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Desktop Firewalls"},"description":{"@type":"string","@value":""},"source":{"@type":"string","@value":"pipeline \"Desktop Firewalls\"\nstage 0 match either\nrule \"Parse - Firewall - GROK\"\nend"},"connected_streams":[{"@type":"string","@value":"8840d80c-d0dd-4769-888d-3b87c355dbae"}]},"constraints":[{"type":"server-version","version":">=5.2.5+7eaa89d"}]},{"id":"673e157e-806e-45fd-bb4a-e2c0bcceb1e5","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Parse - Firewall - GROK"},"description":{"@type":"string","@value":""},"source":{"@type":"string","@value":"rule \"Parse - Firewall - GROK\"\nwhen\n  ( has_field(\"corpNet_route\") &&\nto_string($message.\"corpNet_route\") == \"Desktop Firewall - MS Logs\"\n)\n\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"%{TIMESTAMP_ISO8601:event_timestamp} %{NOTSPACE:action} %{NOTSPACE:protocol} %{IP:source_ip} %{IP:destination_ip}( %{INT:source_port} %{INT:dst_port})? %{GREEDYDATA} %{WORD:path}\",\n  value: to_string($message.\"message\"),\n  only_named_captures: true\n);\nset_fields(\n  fields: gl2_fragment_grok_results\n);\n  set_field(\n    field : \"parse\",\n    value : \"Firewall - GROK\",\n    prefix : \"corpNet_\",\n    clean_field : false\n  );\nend"}},"constraints":[{"type":"server-version","version":">=5.2.5+7eaa89d"}]},{"id":"8840d80c-d0dd-4769-888d-3b87c355dbae","type":{"name":"stream_title","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Desktop Firewall Events"}},"constraints":[{"type":"server-version","version":">=5.2.5+7eaa89d"}]}]}