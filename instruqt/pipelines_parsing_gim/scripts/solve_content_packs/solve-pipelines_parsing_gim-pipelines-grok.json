{"id":"eeae7969-9dde-4d07-80d2-8f8692080a18","rev":2,"v":"1","name":"solve-pipelines_parsing_gim-pipelines-grok","summary":"solve-pipelines_parsing_gim-pipelines-grok","description":"","vendor":"Graylog Service Delivery","url":"","created_at":"2024-04-05T21:11:04.576Z","server_version":"6.0.0-rc.1+61d7f40","parameters":[],"entities":[{"id":"da0585f0-92f5-47e4-b496-804935d043d9","type":{"name":"pipeline","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Desktop Firewalls"},"description":{"@type":"string","@value":""},"source":{"@type":"string","@value":"pipeline \"Desktop Firewalls\"\nstage 0 match either\nrule \"Parse - Firewall - GROK\"\nend"},"connected_streams":[{"@type":"string","@value":"9cc2a47c-03e8-4d29-8e69-ef5d2d816842"}]},"constraints":[{"type":"server-version","version":">=6.0.0-rc.1+61d7f40"}]},{"id":"b62efb2d-6827-46d3-afce-195224fe895f","type":{"name":"pipeline_rule","version":"1"},"v":"1","data":{"title":{"@type":"string","@value":"Parse - Firewall - GROK"},"description":{"@type":"string","@value":""},"source":{"@type":"string","@value":"rule \"Parse - Firewall - GROK\"\nwhen\n  ( has_field(\"route\") &&\nto_string($message.\"route\") == \"Desktop Firewall - MS Logs\"\n)\n\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"%{TIMESTAMP_ISO8601:event_timestamp} %{NOTSPACE:action} %{NOTSPACE:protocol} %{IP:source_ip} %{IP:destination_ip}( %{INT:source_port} %{INT:dst_port})? %{GREEDYDATA} %{WORD:path}\",\n  value: to_string($message.\"message\"),\n  only_named_captures: true\n);\nset_fields(\n  fields: gl2_fragment_grok_results\n);\n  set_field(\n    field : \"parse\",\n    value : \"Firewall - GROK\",\n    clean_field : false\n  );\nend"}},"constraints":[{"type":"server-version","version":">=6.0.0-rc.1+61d7f40"}]},{"id":"9cc2a47c-03e8-4d29-8e69-ef5d2d816842","type":{"name":"stream","version":"1"},"v":"1","data":{"alarm_callbacks":[],"outputs":[],"remove_matches":{"@type":"boolean","@value":false},"title":{"@type":"string","@value":"Desktop Firewall Events"},"stream_rules":[],"alert_conditions":[],"matching_type":{"@type":"string","@value":"AND"},"disabled":{"@type":"boolean","@value":false},"description":{"@type":"string","@value":"Desktop Firewall Events"},"default_stream":{"@type":"boolean","@value":false}},"constraints":[{"type":"server-version","version":">=6.0.0-rc.1+61d7f40"}]}]}