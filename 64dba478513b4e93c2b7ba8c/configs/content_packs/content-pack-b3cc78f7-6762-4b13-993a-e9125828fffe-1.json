{
  "v": 1,
  "id": "b3cc78f7-6762-4b13-993a-e9125828fffe",
  "rev": 1,
  "name": "I'm trouble...",
  "summary": "Troubleshooting Lab",
  "description": "",
  "vendor": "Graylog",
  "url": "",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "fcd61551-9581-447c-8aab-d844d2c62244",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-01.graylog.loc Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"DC-01.graylog.loc Firewall Parser\"\nwhen    // Use routing message to select messages    \ntrue\nthen\nlet pf = split(pattern:\" \", value: to_string($message.message));\nset_field(\"date\",pf[0]);\nset_field(\"time\",pf[1]);\nset_field(\"action\",pf[2]);\nset_field(\"protocol\",pf[3]);\nset_field(\"src-ip\",pf[4]);\nset_field(\"dst-ip\",pf[5]);\nset_field(\"src-port\",pf[6]);\nset_field(\"dst-port\",pf[7]);\nset_field(\"size\",pf[8]);\nset_field(\"path\",pf[16]);\nset_field(\"source\",\"DC-01.graylog.loc\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "6432f5b5-17b0-41d7-a62d-edfda2062fd0",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": false
        },
        "title": {
          "@type": "string",
          "@value": "Apache Logs"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "gl2_source_input"
            },
            "value": {
              "@type": "string",
              "@value": "64f9c83eacc807120a998e84"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "c9ec8dcb-16e7-4608-82a6-4e8a3c910faf",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Monsterfields  Raw/Plaintext TCP"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 1115
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.raw.tcp.RawTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "119aeaf2-edfc-4fb7-a915-143560221979",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Conflictor 2 Raw/Plaintext TCP"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 1112
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.raw.tcp.RawTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "081909ad-1c1d-48bf-a105-930b194e7509",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Too many fields..."
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 5555
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.raw.tcp.RawTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b3201ff9-55fd-4080-8c76-388ddccdfbb7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-02.graylog.loc Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"DC-02.graylog.loc Firewall Parser\"\nwhen    // Use routing message to select messages    \ntrue\nthen\nlet pf = split(pattern:\" \", value: to_string($message.message));\nset_field(\"date\",pf[0]);\nset_field(\"time\",pf[1]);\nset_field(\"action\",pf[2]);\nset_field(\"protocol\",pf[3]);\nset_field(\"src-ip\",pf[4]);\nset_field(\"dst-ip\",pf[5]);\nset_field(\"src-port\",pf[6]);\nset_field(\"dst-port\",pf[7]);\nset_field(\"size\",pf[8]);\nset_field(\"path\",pf[16]);\nset_field(\"parse\",\"Parse - WF - Split\");\nset_field(\"source\",\"DC-02.graylog.loc\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "dd72158d-3df4-4b0d-8080-8d32b3d3c930",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": false
        },
        "title": {
          "@type": "string",
          "@value": "Mac Firewall"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "gl2_source_input"
            },
            "value": {
              "@type": "string",
              "@value": "64f9b3a2acc807120a991858"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2fcfa6e1-158a-4bce-8dbc-72f49491b0b6",
      "data": {
        "title": {
          "@type": "string",
          "@value": "reroute messages"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"reroute messages\"\nwhen\n  has_field(\"winlogbeat_server_request_time\")\nthen\n route_to_stream(\"REPLACE ME!\"); // <-------------!\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "53039bd3-b2a7-4bbf-896d-1a40626140b0",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-02 Firewalls Syslog TCP "
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 5070
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.tcp.SyslogTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "271ba5c8-fdb3-4aa3-87e3-fd5c25ad59c8",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-01 Firewalls Syslog TCP "
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 2020
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.tcp.SyslogTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "48cfae99-c56f-40eb-b1e2-69594ae5437e",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "DC-01.graylog.loc Firewall"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "gl2_source_input"
            },
            "value": {
              "@type": "string",
              "@value": "6509651e8d895959f19de987"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c07f2579-c267-4c92-83f3-bb422b20fafe",
      "data": {
        "title": {
          "@type": "string",
          "@value": "convert fields to string type"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"convert fields to string type\"\nwhen\n  true\nthen\n  let srcport = to_string($message.src_port);\n  let dstport = to_string($message.dst_port);\n  set_field(\"src-port\", srcport);\n  set_field(\"dst-port\", dstport);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "f262a3d6-8b1a-4d25-b89d-a826e658171d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "MAC Firewall"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 5050
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.tcp.SyslogTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "98481009-7dd1-4246-917d-c9176315c85e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "mac firewall"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"mac firewall\"\nstage 0 match all\nrule \"create_host\"\nrule \"MAC Firewall Parser\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "dd72158d-3df4-4b0d-8080-8d32b3d3c930"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "aac4f735-35e8-4eb0-943a-7381c7263169",
      "data": {
        "title": {
          "@type": "string",
          "@value": "set dc-01"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"set dc-01\"\nwhen\ntrue\nthen\n  set_field(\"DC\", to_string(\"dc-01\"));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "f22003c1-2275-420d-9971-9c910953420e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Conflicter  1 Raw/Plaintext TCP"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 1112
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.raw.tcp.RawTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "5eeab14e-a496-41e9-bf7a-5c28bb4f3422",
      "data": {
        "title": {
          "@type": "string",
          "@value": "UDP - Where are my logs...?"
        },
        "configuration": {
          "port": {
            "@type": "integer",
            "@value": 1114
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 262144
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.udp.SyslogUDPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "9d02229e-1ae0-4843-b418-50c3f9a65390",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "DC-02.graylog.loc Firewall"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "gl2_source_input"
            },
            "value": {
              "@type": "string",
              "@value": "64f9df0dacc807120a9a2746"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "c47043a4-0a76-44fd-b80d-485d22530312",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "Too many fields..."
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "gl2_source_input"
            },
            "value": {
              "@type": "string",
              "@value": "65096a648d895959f19e1419"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "d6ca7f4e-440f-454c-b5a4-3ff63780d04d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "GELF on a shelf..."
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 5080
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": true
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "decompress_size_limit": {
            "@type": "integer",
            "@value": 8388608
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.gelf.tcp.GELFTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "d0559e9f-5f8c-44d2-afed-0cf24cd1ca2d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "MAC Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": "tcp4 10.5.5.49:52342<->212.34.186.8:443,en0,1507,5871,24.47 ms"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"MAC Firewall Parser\"\nwhen    // Use routing message to select messages    \ntrue\nthen\nlet pf = split(pattern:\",\", value: to_string($message.message));\nset_field(\"action\",pf[0]);\nset_field(\"interface\",pf[1]);\nset_field(\"src-por\",pf[2]);\nset_field(\"dst-port\",pf[3]);\nset_field(\"time\",pf[5]); // <----- I forgot how to count....\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "cb6ca3a1-fbd8-4ff1-ae01-bc864039087e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Apache Logs"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 5060
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.tcp.SyslogTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": false
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "e764a7b2-60e4-4b41-ba2b-0ed4f3b02811",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Apache Logs"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Apache Logs\"\nstage 0 match pass\nrule \"BREAK IT!\"\nstage 1 match either\nrule \"BREAK IT!\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "6432f5b5-17b0-41d7-a62d-edfda2062fd0"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "03f960a6-a0ee-4ef2-9d1b-19892fbc3f35",
      "data": {
        "title": {
          "@type": "string",
          "@value": "set dc-02"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"set dc-02\"\nwhen\ntrue\nthen\n  set_field(\"DC\", to_long(\"02\"));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "a5659468-8d8e-4d81-bead-5365c66619e7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-01.graylog.loc Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"DC-01.graylog.loc Firewall Parser\"\nstage 0 match either\nrule \"DC-01.graylog.loc Firewall Parser\"\nstage 1 match pass\nstage 2 match either\nrule \"set dc-01\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "48cfae99-c56f-40eb-b1e2-69594ae5437e"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "eb437964-5aad-4b8f-81e8-cf80581e7cce",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-02.graylog.loc Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"DC-02.graylog.loc Firewall Parser\"\nstage 0 match either\nrule \"DC-02.graylog.loc Firewall Parser\"\nstage 1 match either\nrule \"set dc-02\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "9d02229e-1ae0-4843-b418-50c3f9a65390"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "7e4cd6e4-44dd-4291-a042-bfc108e046b0",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Too many fields..."
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Too many fields...\"\nstage 0 match either\nrule \"too_many_parser\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "c47043a4-0a76-44fd-b80d-485d22530312"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "323aa482-b6fb-456c-b4e6-0b4565f8b2cd",
      "data": {
        "title": {
          "@type": "string",
          "@value": "convert fields to Long type"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"convert fields to Long type\"\nwhen\n  true\nthen\n  let srcport = to_long($message.src_port);\n  let dstport = to_long($message.dst_port);\n  set_field(\"src-port\", srcport);\n  set_field(\"dst-port\", dstport);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "47f2087e-c95a-4457-a390-42803a0edcac",
      "data": {
        "title": {
          "@type": "string",
          "@value": "too_many_parser"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"too_many_parser\"\nwhen\ntrue\nthen\nset_fields(\n   fields:key_value(\n   value: to_string($message.message),\n   delimiters:\" \",\n   kv_delimiters:\"=\"\n)\n);\nset_field(\"message\", \"success!\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "60169b86-0a3b-44e3-9d4a-121f17f0f34a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "BREAK IT!"
        },
        "description": {
          "@type": "string",
          "@value": "108.247.202.16 www.buttercup.com - trice9 443 [01/Aug/2018 11:40:35:813745] \"POST /cart?action=checkout&product_name=Man_Candle-Bacon&JSESSIONID=E0F5EF774954 HTTP/1.1\" \"?action=checkout&product_name=Man_Candle-Bacon&JSESSIONID=E0F5EF774954\" 503 599 \"https://www.buttercup.com/view?q=Man_Candle-Bacon\" \"Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML; like Gecko) Chrome/30.0.1599.69 Safari/537.36\" 104 2371 5122293"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"BREAK IT!\"\nwhen\nregex(\"(^CURRENT SESSION).*Uploaded:(.*? MB)\", to_string($message.message)).matches == false AND \nregex(\"(^CURRENT SESSION).*Uploaded:(.*? KB)\", to_string($message.message)).matches == false AND \nregex(\"(^CURRENT SESSION).*Uploaded:(.*? GB)\", to_string($message.message)).matches == false AND \nregex(\"(^CURRENT SESSION).*Uploaded:(.*? LB)\", to_string($message.message)).matches == false AND\nregex(\"(^CURRENT SESSION).*Uploaded:(.*? MB$)\", to_string($message.message)).matches == false AND \nregex(\"(^CURRENT SESSION).*Uploaded:(.*? KB$)\", to_string($message.message)).matches == false AND \nregex(\"(^CURRENT SESSION).*Uploaded:(.*? GB$)\", to_string($message.message)).matches == false AND \nregex(\"(^CURRENT SESSION).*Uploaded:(.*? LB$)\", to_string($message.message)).matches == false AND\nregex(\"([^.]*)\\\\.([^.]*)\\\\.\\\\.([^.]*)\\\\.\", to_string($message.message)).matches == false AND\nregex(\"([^.]*)\\\\.\\\\.([^.]*)\\\\.\", to_string($message.message)).matches == false\nthen\nlet result = regex(\"([^.]*)\\\\.([^.]*)\\\\.\\\\.([^.]*)\\\\.\", to_string($message.message));\nset_field(\"date\", result[\"1\"]);\nset_field(\"token_id\", result[\"2\"]);\nset_field(\"status\", result[\"3\"]);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "248aeddc-5612-4537-97ea-73605fef494e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "create_host"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"create_host\"\nwhen\ntrue\nthen\nset_field(\"hostname\", \"yourboysmac\");\nend \n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    }
  ]
}