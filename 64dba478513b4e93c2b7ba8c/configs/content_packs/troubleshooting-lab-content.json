{
  "v": 1,
  "id": "e3018e83-c132-481d-b934-92ddc2305ef6",
  "rev": 1,
  "name": "Troubleshooting v2",
  "summary": "Troubleshooting v2",
  "description": "Troubleshooting v2",
  "vendor": "Graylog",
  "url": "",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "f4644523-ba41-4033-bf21-a6a8bd7376ba",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-02.graylog.loc Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"DC-02.graylog.loc Firewall Parser\"\nstage 0 match either\nrule \"DC-02.graylog.loc Firewall Parser\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "60f97d18-1811-4edd-81f8-93e43ead20aa"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "1e1b3964-0141-4ab2-8e63-93795fc3ece0",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "MonsterFields 2"
        },
        "stream_rules": [],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "MonsterFields 2"
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "1a950a95-cc7d-4b32-9729-c27f43813945",
      "data": {
        "title": {
          "@type": "string",
          "@value": "mac firewall"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"mac firewall\"\nstage 0 match all\nrule \"create_host\"\nrule \"MAC Firewall Parser\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "49e3debe-d8a5-4d26-9df0-dd4c929002c5"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "c8374a02-d154-4108-bd55-af94eee2a3d0",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Apache Logs"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 5060
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.tcp.SyslogTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "edecf191-ec6e-4b1b-b943-32ab5da81df3",
      "data": {
        "title": {
          "@type": "string",
          "@value": "UDP - Where are my Logs...?"
        },
        "configuration": {
          "port": {
            "@type": "integer",
            "@value": 1114
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 262144
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.udp.SyslogUDPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "7a2ed6f3-01b1-41de-9511-6f6066fa74b7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-01.graylog.loc Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"DC-01.graylog.loc Firewall Parser\"\nwhen    // Use routing message to select messages    \ntrue\nthen\nlet pf = split(pattern:\" \", value: to_string($message.message));\nset_field(\"date\",pf[0]);\nset_field(\"time\",pf[1]);\nset_field(\"action\",pf[2]);\nset_field(\"protocol\",pf[3]);\nset_field(\"src-ip\",pf[4]);\nset_field(\"dst-ip\",pf[5]);\nset_field(\"src-port\",pf[6]);\nset_field(\"dst-port\",pf[7]);\nset_field(\"size\",pf[8]);\nset_field(\"path\",pf[16]);\nset_field(\"source\",\"DC-01.graylog.loc\");\nset_field(\"DC\",to_string(\"01\"));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "080b16ce-05e8-450e-affa-4d8485209d94",
      "data": {
        "title": {
          "@type": "string",
          "@value": "GELF on a shelf..."
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 5080
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": true
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "decompress_size_limit": {
            "@type": "integer",
            "@value": 8388608
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.gelf.tcp.GELFTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "ddb7ea9b-63ab-4a8d-b545-89a9463d3a83",
      "data": {
        "title": {
          "@type": "string",
          "@value": "key_value_parser"
        },
        "description": {
          "@type": "string",
          "@value": "Parse Monster fields Parser"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"key_value_parser\"\nwhen\ntrue\nthen\nset_fields(\n   fields:key_value(\n   value: to_string($message.message),\n   trim_value_chars: \"\\\"\",\n   trim_key_chars:\"\\\"\",\n   delimiters:\" \",\n   kv_delimiters:\"=\"\n)\n);\nset_field(\"message\", \"600 fields of log\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "72a2ace0-00f9-4736-af04-d5975bee6b75",
      "data": {
        "title": {
          "@type": "string",
          "@value": "MAC Firewall"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 5050
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 2
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.tcp.SyslogTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "ddbc46b7-5640-44ce-9f3e-d81c436e55cf",
      "data": {
        "title": {
          "@type": "string",
          "@value": "MonsterFields"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"MonsterFields\"\nstage 0 match either\nrule \"key_value_parser\"\nstage 1 match either\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "2a1b52d9-b96e-4f74-9ef4-33a1cc16880a"
          },
          {
            "@type": "string",
            "@value": "1e1b3964-0141-4ab2-8e63-93795fc3ece0"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "49e3debe-d8a5-4d26-9df0-dd4c929002c5",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": false
        },
        "title": {
          "@type": "string",
          "@value": "Mac Firewall"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "gl2_source_input"
            },
            "value": {
              "@type": "string",
              "@value": "64f9b3a2acc807120a991858"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "053aad60-365e-4594-ba77-ce007f4dd65f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Monsterfields  Raw/Plaintext TCP"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 514
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.raw.tcp.RawTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "ab4f5a9b-07be-490f-a68c-5a30bf913e2c",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Conflicter  1 Raw/Plaintext TCP"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 1112
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.raw.tcp.RawTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "479ab0d7-a96c-4fff-ac24-209be1cb976d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Split Monsterfields by source"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Split Monsterfields by source\"\nwhen\n  contains(\"monstersource2\", to_string($message.source))\nthen\n  route_to_stream(\"MonsterFields 2\");\n  remove_from_stream(\"MonsterFields 1\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "ceaf8d56-012f-4f54-8c44-c1d9ba11af01",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Apache Logs"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Apache Logs\"\nstage 0 match either\nrule \"BREAK IT!\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "49375657-108f-43d8-b0e2-5019ad9ab3c2"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "feeee7f0-fa36-485d-a9cf-e175369616bd",
      "data": {
        "title": {
          "@type": "string",
          "@value": "BREAK IT!"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"BREAK IT!\"\nwhen\nregex(\"(^CURRENT SESSION).*Uploaded:(.*? MB)\", to_string($message.message)).matches == true AND \nregex(\"(^CURRENT SESSION).*Uploaded:(.*? KB)\", to_string($message.message)).matches == true AND \nregex(\"(^CURRENT SESSION).*Uploaded:(.*? GB)\", to_string($message.message)).matches == true AND \nregex(\"(^CURRENT SESSION).*Uploaded:(.*? LB)\", to_string($message.message)).matches == true AND\nregex(\"([^.]*)\\\\.([^.]*)\\\\.\\\\.([^.]*)\\\\.\", to_string($message.message)).matches == true AND\nregex(\"([^.]*)\\\\.\\\\.([^.]*)\\\\.\", to_string($message.message)).matches == true\nthen\nlet result = regex(\"([^.]*)\\\\.([^.]*)\\\\.\\\\.([^.]*)\\\\.\", to_string($message.message));\nset_field(\"date\", result[\"1\"]);\nset_field(\"token_id\", result[\"2\"]);\nset_field(\"status\", result[\"3\"]);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "99293e19-a9e9-4b9c-abac-2434e8518e43",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-01.graylog.loc Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"DC-01.graylog.loc Firewall Parser\"\nstage 0 match either\nrule \"DC-01.graylog.loc Firewall Parser\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "60f97d18-1811-4edd-81f8-93e43ead20aa"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "355f5285-a69f-40b2-9777-da21a9ff7685",
      "data": {
        "title": {
          "@type": "string",
          "@value": "MAC Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": "tcp4 10.5.5.49:52342<->212.34.186.8:443,en0,1507,5871,24.47 ms"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"MAC Firewall Parser\"\nwhen    // Use routing message to select messages    \ntrue\nthen\nlet pf = split(pattern:\",\", value: to_string($message.message));\nset_field(\"action\",pf[0]);\nset_field(\"interface\",pf[1]);\nset_field(\"src-por\",pf[2]);\nset_field(\"dst-port\",pf[3]);\nset_field(\"time\",pf[5]); // <----- I forgot how to count....\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "49375657-108f-43d8-b0e2-5019ad9ab3c2",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": false
        },
        "title": {
          "@type": "string",
          "@value": "Apache Logs"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "EXACT"
            },
            "field": {
              "@type": "string",
              "@value": "gl2_source_input"
            },
            "value": {
              "@type": "string",
              "@value": "64f9c83eacc807120a998e84"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "914d9a88-f601-4e1f-bbe6-c34ed6f05dd9",
      "data": {
        "title": {
          "@type": "string",
          "@value": "create_host"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"create_host\"\nwhen\ntrue\nthen\nset_field(\"hostname\", \"yourboysmac\");\nend \n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "254d6e66-8ba3-44d2-b0dc-105de3693e8a",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": false
        },
        "title": {
          "@type": "string",
          "@value": "Syslog format messages"
        },
        "stream_rules": [],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "3cc8c222-64bd-4cc4-8a8a-c193cef6c64a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Conflictor 2 Raw/Plaintext TCP"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 1112
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.raw.tcp.RawTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "60f97d18-1811-4edd-81f8-93e43ead20aa",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "DC.graylog.loc Firewall"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "MATCH_INPUT"
            },
            "field": {
              "@type": "string",
              "@value": ""
            },
            "value": {
              "@type": "string",
              "@value": "64fb0e70f401433cc236943f"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "2a1b52d9-b96e-4f74-9ef4-33a1cc16880a",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "MonsterFields 1"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "MATCH_INPUT"
            },
            "field": {
              "@type": "string",
              "@value": ""
            },
            "value": {
              "@type": "string",
              "@value": "64fb0e70f401433cc2369444"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "6b2c36a6-5221-4ff5-a587-28b2a7321b9b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC-02.graylog.loc Firewall Parser"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"DC-02.graylog.loc Firewall Parser\"\nwhen    // Use routing message to select messages    \ntrue\nthen\nlet pf = split(pattern:\" \", value: to_string($message.message));\nset_field(\"date\",pf[0]);\nset_field(\"time\",pf[1]);\nset_field(\"action\",pf[2]);\nset_field(\"protocol\",pf[3]);\nset_field(\"src-ip\",pf[4]);\nset_field(\"dst-ip\",pf[5]);\nset_field(\"src-port\",pf[6]);\nset_field(\"dst-port\",pf[7]);\nset_field(\"size\",pf[8]);\nset_field(\"path\",pf[16]);\nset_field(\"source\",\"DC-02.graylog.loc\");\nset_field(\"DC\",to_long(\"02\"));\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "57062926-d5ac-40e3-a6ba-90f0dbf3a118",
      "data": {
        "title": {
          "@type": "string",
          "@value": "DC Firewalls Syslog TCP"
        },
        "configuration": {
          "tls_key_file": {
            "@type": "string",
            "@value": ""
          },
          "port": {
            "@type": "integer",
            "@value": 1514
          },
          "tls_enable": {
            "@type": "boolean",
            "@value": false
          },
          "use_null_delimiter": {
            "@type": "boolean",
            "@value": false
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "tcp_keepalive": {
            "@type": "boolean",
            "@value": false
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": true
          },
          "tls_client_auth_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "tls_cert_file": {
            "@type": "string",
            "@value": ""
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "max_message_size": {
            "@type": "integer",
            "@value": 2097152
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": false
          },
          "tls_client_auth": {
            "@type": "string",
            "@value": "disabled"
          },
          "timezone": {
            "@type": "string",
            "@value": "NotSet"
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 8
          },
          "tls_key_password": {
            "@type": "string",
            "@value": ""
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.tcp.SyslogTCPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=5.1.4+6fa2de3"
        }
      ]
    }
  ]
}